<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X and O Game (Tic-Tac-Toe)</title>
    <style>
        body {
            background: #eee;
            font-family: Arial, sans-serif;
        }
        .container {
            width: 350px;
            margin: 40px auto;
            background: #fff;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 20px;
        }
        h1 {
            text-align: center;
            font-size: 2em;
        }
        .board {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 5px;
            margin: 20px auto;
        }
        .cell {
            width: 60px;
            height: 60px;
            background: #fafafa;
            border: 1px solid #333;
            font-size: 2em;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
        }
        #statusDisplay {
            text-align: center;
            margin-bottom: 10px;
            min-height: 24px;
        }
        #scoreX, #scoreO {
            font-weight: bold;
        }
        #restartButton {
            width: 100%;
            padding: 10px;
            background: #4caf50;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Tic-Tac-Toe</h1>
        <div style="margin-bottom:10px;text-align:center;">
            <label for="difficulty">Difficulty:</label>
            <select id="difficulty">
                <option value="easy">Easy</option>
                <option value="hard" selected>Hard</option>
                <option value="impossible">Almost Impossible</option>
            </select>
        </div>
        <div id="statusDisplay">Welcome!</div>
        <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
            <div>X Wins: <span id="scoreX">0</span></div>
            <div>O Wins: <span id="scoreO">0</span></div>
        </div>
        <div class="board">
            <div class="cell" data-cell-index="0"></div>
            <div class="cell" data-cell-index="1"></div>
            <div class="cell" data-cell-index="2"></div>
            <div class="cell" data-cell-index="3"></div>
            <div class="cell" data-cell-index="4"></div>
            <div class="cell" data-cell-index="5"></div>
            <div class="cell" data-cell-index="6"></div>
            <div class="cell" data-cell-index="7"></div>
            <div class="cell" data-cell-index="8"></div>
        </div>
        <button id="restartButton">Restart Game</button>
    </div>

    <script>
    // BEGINNER JAVASCRIPT
    var statusDisplay = document.getElementById('statusDisplay');
    var scoreDisplayX = document.getElementById('scoreX');
    var scoreDisplayO = document.getElementById('scoreO');
    var cells = document.getElementsByClassName('cell');
    var gameActive = true;
    var currentPlayer = 'X';
    var gameState = ['', '', '', '', '', '', '', '', ''];
    var scoreX = 0;
    var scoreO = 0;
    var winningConditions = [
        [0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]
    ];

    function updateScoreDisplay() {
        scoreDisplayX.innerText = scoreX;
        scoreDisplayO.innerText = scoreO;
    }

    function setStatus(msg) {
        statusDisplay.innerText = msg;
    }

    function checkWinner(state) {
        for (var i=0;i<winningConditions.length;i++) {
            var a = winningConditions[i][0];
            var b = winningConditions[i][1];
            var c = winningConditions[i][2];
            if (state[a] && state[a] === state[b] && state[a] === state[c]) {
                return state[a];
            }
        }
        return null;
    }

    function handleCellClick(e) {
        var idx = parseInt(e.target.getAttribute('data-cell-index'));
        if (gameState[idx] !== '' || !gameActive) return;
        gameState[idx] = currentPlayer;
        e.target.innerText = currentPlayer;
        var winner = checkWinner(gameState);
        if (winner) {
            setStatus('Player ' + winner + ' wins!');
            gameActive = false;
            if (winner === 'X') scoreX++;
            else scoreO++;
            updateScoreDisplay();
            return;
        }
        if (gameState.indexOf('') === -1) {
            setStatus('Draw!');
            gameActive = false;
            return;
        }
        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
        setStatus("It's " + currentPlayer + "'s turn");
        if (currentPlayer === 'O' && gameActive) {
            setTimeout(aiMove, 400);
        }
    }

    function aiMove() {
        var difficulty = document.getElementById('difficulty').value;
        var move;
        var emptyCells = [];
        for (var i=0;i<gameState.length;i++) {
            if (gameState[i] === '') emptyCells.push(i);
        }
        if (difficulty === 'easy') {
            move = emptyCells[Math.floor(Math.random()*emptyCells.length)];
        } else if (difficulty === 'hard') {
            if (Math.random()<0.5) {
                move = emptyCells[Math.floor(Math.random()*emptyCells.length)];
            } else {
                move = getBestMove();
            }
        } else {
            move = getBestMove();
        }
        if (move !== undefined && gameState[move] === '') {
            gameState[move] = 'O';
            cells[move].innerText = 'O';
            var winner = checkWinner(gameState);
            if (winner) {
                setStatus('Player ' + winner + ' wins!');
                gameActive = false;
                if (winner === 'X') scoreX++;
                else scoreO++;
                updateScoreDisplay();
                return;
            }
            if (gameState.indexOf('') === -1) {
                setStatus('Draw!');
                gameActive = false;
                return;
            }
            currentPlayer = 'X';
            setStatus("It's X's turn");
        }
    }

    function getBestMove() {
        // BEGINNER MINIMAX (inefficient, verbose)
        var bestScore = -Infinity;
        var move;
        for (var i=0;i<gameState.length;i++) {
            if (gameState[i] === '') {
                gameState[i] = 'O';
                var score = minimax(gameState, 0, false);
                gameState[i] = '';
                if (score > bestScore) {
                    bestScore = score;
                    move = i;
                }
            }
        }
        return move;
    }

    function minimax(state, depth, isMax) {
        var winner = checkWinner(state);
        if (winner === 'O') return 10-depth;
        if (winner === 'X') return depth-10;
        if (state.indexOf('') === -1) return 0;
        if (isMax) {
            var best = -Infinity;
            for (var i=0;i<state.length;i++) {
                if (state[i] === '') {
                    state[i] = 'O';
                    var val = minimax(state, depth+1, false);
                    state[i] = '';
                    if (val > best) best = val;
                }
            }
            return best;
        } else {
            var best = Infinity;
            for (var i=0;i<state.length;i++) {
                if (state[i] === '') {
                    state[i] = 'X';
                    var val = minimax(state, depth+1, true);
                    state[i] = '';
                    if (val < best) best = val;
                }
            }
            return best;
        }
    }

    function handleRestartGame() {
        gameActive = true;
        currentPlayer = 'X';
        gameState = ['', '', '', '', '', '', '', '', ''];
        for (var i=0;i<cells.length;i++) {
            cells[i].innerText = '';
        }
        setStatus("It's X's turn");
    }

    for (var i=0;i<cells.length;i++) {
        cells[i].onclick = handleCellClick;
    }
    document.getElementById('restartButton').onclick = handleRestartGame;
    setStatus("It's X's turn");
    updateScoreDisplay();
    </script>
</body>
</html>
